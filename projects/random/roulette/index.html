<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤ì˜¨ ë£°ë ›: ìš´ëª…ì˜ ê²°ì •</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --accent: #d500f9; /* ë„¤ì˜¨ í¼í”Œ */
            --text-main: #e0e0e0;
            --neon-shadow: 0 0 10px var(--accent), 0 0 20px var(--accent);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Pretendard', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* --- íƒ€ì´í‹€ --- */
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            font-weight: 800;
            color: #fff;
            text-shadow: var(--neon-shadow);
            letter-spacing: 2px;
        }

        /* --- ë£°ë › ì»¨í…Œì´ë„ˆ --- */
        .roulette-wrapper {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 20px auto;
        }

        canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(213, 0, 249, 0.2);
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        /* í™”ì‚´í‘œ (í¬ì¸í„°) */
        .pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #fff;
            filter: drop-shadow(0 0 10px #fff);
            z-index: 10;
        }

        /* --- ì»¨íŠ¸ë¡¤ íŒ¨ë„ --- */
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            z-index: 20;
        }

        .btn {
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
            text-transform: uppercase;
        }
        .btn:hover {
            background: var(--accent);
            color: #fff;
            box-shadow: 0 0 30px var(--accent);
        }
        .btn:disabled {
            border-color: #555; color: #555; cursor: not-allowed; box-shadow: none; background: transparent;
        }

        /* --- íŒì—… (ì„¤ì • & ê²°ê³¼) --- */
        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .modal.active { display: flex; opacity: 1; }

        .modal-content {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid #333;
            text-align: center;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        textarea {
            width: 100%;
            height: 150px;
            background: #111;
            border: 1px solid #444;
            color: #fff;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1rem;
            resize: none;
        }
        textarea:focus { outline: none; border-color: var(--accent); }

        .winner-text {
            font-size: 4rem;
            font-weight: 900;
            color: #fff;
            margin: 20px 0;
            text-shadow: 0 0 20px var(--accent);
            animation: zoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes zoomIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    </style>
</head>
<body>

    <h1>CYBER ROULETTE</h1>
    
    <div class="roulette-wrapper">
        <div class="pointer"></div>
        <canvas id="wheel" width="1000" height="1000"></canvas>
    </div>

    <div class="controls">
        <button class="btn" id="spin-btn" onclick="spinWheel()">SPIN!</button>
        <button class="btn" onclick="openEditModal()" style="border-color:#00e676; color:#00e676;">ğŸ“ ëª©ë¡ ìˆ˜ì •</button>
    </div>

    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom:10px;">ì°¸ì—¬ì ëª©ë¡ ìˆ˜ì •</h2>
            <p style="color:#aaa; font-size:0.9rem;">ì´ë¦„ì„ ì¤„ë°”ê¿ˆ(ì—”í„°)ìœ¼ë¡œ êµ¬ë¶„í•´ì„œ ì ì–´ì£¼ì„¸ìš”.</p>
            <textarea id="name-input" placeholder="ê¹€ì² ìˆ˜&#10;ì´ì˜í¬&#10;ë°•ë¯¼ìˆ˜"></textarea>
            
            <div style="display:flex; gap:10px; justify-content:center;">
                <button class="btn" onclick="applyNames()">ì ìš©í•˜ê¸°</button>
                <button class="btn" onclick="setNumbers()" style="font-size:0.9rem; border-color:#aaa; color:#aaa;">ğŸ”¢ ë²ˆí˜¸ ìë™ ìƒì„±</button>
            </div>
            <button class="btn" onclick="closeModal('edit-modal')" style="border:none; color:#555; margin-top:10px;">ë‹«ê¸°</button>
        </div>
    </div>

    <div id="result-modal" class="modal">
        <div class="modal-content" style="border-color: var(--accent);">
            <h2 style="color:var(--accent);">ğŸ‰ ë‹¹ì²¨ ğŸ‰</h2>
            <div id="winner-display" class="winner-text">ìš°ìŠ¹ì</div>
            <button class="btn" onclick="closeModal('result-modal')">í™•ì¸</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spin-btn');
        
        let names = ["ë°œí‘œ", "ì²­ì†Œ", "ê°„ì‹", "ë…¸ë˜", "íŒ¨ìŠ¤", "ë‹¹ì²¨"]; // ê¸°ë³¸ê°’
        let colors = [];
        let startAngle = 0;
        let arc = Math.PI / (names.length / 2);
        let spinTimeout = null;
        let spinAngleStart = 10;
        let spinTime = 0;
        let spinTimeTotal = 0;
        let isSpinning = false;

        // ë„¤ì˜¨ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ (ëœë¤)
        function getColor(i, total) {
            const hue = i * (360 / total);
            return `hsl(${hue}, 80%, 60%)`;
        }

        function drawRouletteWheel() {
            arc = Math.PI / (names.length / 2); // ê°ë„ ê³„ì‚°
            ctx.clearRect(0, 0, 1000, 1000); // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
            
            const outsideRadius = 480;
            const textRadius = 350;
            const insideRadius = 50;

            ctx.strokeStyle = "#121212"; // êµ¬ë¶„ì„  ìƒ‰ìƒ
            ctx.lineWidth = 5;

            for(let i = 0; i < names.length; i++) {
                const angle = startAngle + i * arc;
                
                // 1. ë¶€ì±„ê¼´ ê·¸ë¦¬ê¸°
                ctx.fillStyle = getColor(i, names.length);
                ctx.beginPath();
                ctx.arc(500, 500, outsideRadius, angle, angle + arc, false);
                ctx.arc(500, 500, insideRadius, angle + arc, angle, true);
                ctx.fill();
                ctx.stroke();

                // 2. í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
                ctx.save();
                ctx.fillStyle = "#000"; // ê¸€ììƒ‰
                ctx.font = 'bold 40px Pretendard, sans-serif'; // ê¸€ê¼´ í¬ê¸°
                
                // í…ìŠ¤íŠ¸ ìœ„ì¹˜ ê³„ì‚° (ì¤‘ì‹¬ì¶• íšŒì „)
                ctx.translate(500 + Math.cos(angle + arc / 2) * textRadius, 
                              500 + Math.sin(angle + arc / 2) * textRadius);
                ctx.rotate(angle + arc / 2 + Math.PI / 2);
                
                const text = names[i];
                // ê¸€ìê°€ ë„ˆë¬´ ê¸¸ë©´ ì˜ë¼ë‚´ê¸°
                const metrics = ctx.measureText(text);
                if (metrics.width > 180) {
                    ctx.fillText(text.substring(0, 5) + "..", -ctx.measureText(text.substring(0, 5) + "..").width / 2, 0);
                } else {
                    ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
                }
                ctx.restore();
            }
        }

        // --- íšŒì „ ë¡œì§ ---
        function spinWheel() {
            if(isSpinning) return;
            isSpinning = true;
            spinBtn.disabled = true;

            spinAngleStart = Math.random() * 10 + 30; // ì´ˆê¸° íšŒì „ ì†ë„ (ëœë¤)
            spinTime = 0;
            spinTimeTotal = Math.random() * 3000 + 4000; // ì´ íšŒì „ ì‹œê°„ (4~7ì´ˆ)
            rotateWheel();
        }

        function rotateWheel() {
            spinTime += 30;
            if(spinTime >= spinTimeTotal) {
                stopRotateWheel();
                return;
            }
            
            // ê°ì† ê³µì‹ (Ease Out)
            const spinAngle = spinAngleStart - easeOut(spinTime, 0, spinAngleStart, spinTimeTotal);
            startAngle += (spinAngle * Math.PI / 180);
            drawRouletteWheel();
            
            spinTimeout = requestAnimationFrame(rotateWheel);
        }

        function stopRotateWheel() {
            cancelAnimationFrame(spinTimeout);
            isSpinning = false;
            spinBtn.disabled = false;

            // ê²°ê³¼ ê³„ì‚°
            const degrees = startAngle * 180 / Math.PI + 90;
            const arcd = arc * 180 / Math.PI;
            const index = Math.floor((360 - degrees % 360) / arcd);
            
            ctx.save();
            const text = names[index];
            showResult(text);
            ctx.restore();
        }

        function easeOut(t, b, c, d) {
            const ts = (t/=d)*t;
            const tc = ts*t;
            return b+c*(tc + -3*ts + 3*t);
        }

        // --- ëª¨ë‹¬ ì œì–´ ---
        function showResult(text) {
            const modal = document.getElementById('result-modal');
            document.getElementById('winner-display').innerText = text;
            modal.classList.add('active');
            
            // ì¶•í•˜ íš¨ê³¼ (ê°„ë‹¨í•œ íŒŒí‹°í´ ëŒ€ì‹  ë°°ê²½ ê¹œë¹¡ì„)
            document.body.style.backgroundColor = "#2a002a";
            setTimeout(() => document.body.style.backgroundColor = "#121212", 300);
        }

        function openEditModal() {
            const modal = document.getElementById('edit-modal');
            const textarea = document.getElementById('name-input');
            textarea.value = names.join('\n'); // í˜„ì¬ ëª©ë¡ì„ ì¤„ë°”ê¿ˆìœ¼ë¡œ í‘œì‹œ
            modal.classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        // --- ë°ì´í„° ìˆ˜ì • ---
        function applyNames() {
            const textarea = document.getElementById('name-input');
            const raw = textarea.value.trim();
            if(!raw) {
                alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }
            // ì¤„ë°”ê¿ˆìœ¼ë¡œ ë‚˜ëˆ„ê³  ë¹ˆ ì¤„ ì œê±°
            names = raw.split('\n').map(n => n.trim()).filter(n => n !== "");
            
            if(names.length < 2) {
                alert("ìµœì†Œ 2ê°œ ì´ìƒì˜ í•­ëª©ì´ í•„ìš”í•©ë‹ˆë‹¤.");
                return;
            }

            closeModal('edit-modal');
            drawRouletteWheel();
        }

        // [ìˆ˜ì •ë¨] 1~Në²ˆ ìë™ ìƒì„± ê¸°ëŠ¥
        function setNumbers() {
            // ì‚¬ìš©ìì—ê²Œ ëª‡ ë²ˆê¹Œì§€ ë§Œë“¤ì§€ ë¬¼ì–´ë´„
            const input = prompt("ìµœëŒ€ ëª‡ ë²ˆê¹Œì§€ ë§Œë“¤ê¹Œìš”? (ì˜ˆ: 25)", "30");
            
            // ì·¨ì†Œ ë²„íŠ¼ì„ ëˆŒë €ì„ ê²½ìš°
            if (input === null) return;

            const maxNum = parseInt(input);

            // ìœ íš¨ì„± ê²€ì‚¬ (ìˆ«ìê°€ ì•„ë‹ˆê±°ë‚˜ 2ë³´ë‹¤ ì‘ìœ¼ë©´ ê²½ê³ )
            if (isNaN(maxNum) || maxNum < 2) {
                alert("2 ì´ìƒì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            // ë²ˆí˜¸ ìƒì„±
            const nums = [];
            for(let i=1; i<=maxNum; i++) nums.push(i + "ë²ˆ");
            
            document.getElementById('name-input').value = nums.join('\n');
        }

        // ì´ˆê¸° ì‹¤í–‰
        drawRouletteWheel();

    </script>
</body>
</html>